{"version":3,"file":"sails.model.js","sourceRoot":"","sources":["../src/sails.model.ts"],"names":[],"mappings":";;;;;;;;;AAAA,OAAO,EAAE,QAAQ,EAAE,WAAW,EAAE,MAAM,mBAAmB,CAAC;AAE1D,OAAO,EAAE,QAAQ,EAAE,MAAM,4BAA4B,CAAC;AACtD,OAAO,EAAE,QAAQ,EAAE,MAAM,SAAS,CAAC;;IAEnC;QAEgB,OAAE,GAAW,EAAE,CAAC;IAkDhC,CAAC;mBAnDqB,UAAU;IAK5B,gCAAW,GAAX;QACI,OAAO,IAAI,CAAC,WAAW,EAAE,CAAC;IAC9B,CAAC;IAEM,oBAAS,GAAhB,UAAgD,KAAQ;QACpD,IAAM,IAAI,GAAG,UAAC,GAAG;YACb,KAAK,IAAM,GAAG,IAAI,GAAG,EAAE;gBACnB,IAAM,IAAI,GAAM,GAAG,CAAC,GAAG,CAAC,CAAC;gBACzB,qBAAqB;gBACrB,IAAI,IAAI,KAAK,IAAI,IAAI,OAAO,IAAI,KAAK,UAAU,EAAE;oBAC7C,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC;iBACnB;gBAED,sDAAsD;gBACtD,IAAI,IAAI,IAAI,IAAI,YAAY,YAAU,IAAI,IAAI,CAAC,EAAE,KAAK,IAAI,EAAE;oBACxD,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC;iBACtB;gBAED,IAAI,IAAI,IAAI,IAAI,YAAY,YAAU,EAAE;oBACpC,GAAG,CAAC,GAAG,CAAC,GAAG,YAAU,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;iBACzC;gBAED,IAAI,IAAI,IAAI,IAAI,YAAY,KAAK,EAAE;oBAC/B,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,UAAA,EAAE;wBAClB,IAAI,EAAE,YAAY,YAAU,EAAE;4BAC1B,OAAO,YAAU,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;yBACnC;wBAED,OAAO,EAAE,CAAC;oBACd,CAAC,CAAC,CAAC;iBACN;aACJ;YACD,OAAO,GAAG,CAAC;QACf,CAAC,CAAC;QACF,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC;IAC1C,CAAC;IAEM,sBAAW,GAAlB,UAAkD,UAAU,EAAE,IAAa;QACvE,IAAM,MAAM,GAAG,UAAC,KAAK,IAAK,OAAA,WAAW,CAAI,UAAU,EAAE,KAAK,CAAM,EAAtC,CAAsC,CAAC;QACjE,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACrB,OAAO,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;SAC3B;aAAM,IAAI,QAAQ,CAAC,IAAI,CAAC,EAAE;YACvB,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;SACvB;QACD,MAAM,IAAI,KAAK,CAAC,4GAA4G,CAAC,CAAC;IAClI,CAAC;;IAjDW;QAAX,QAAQ,EAAE;;0CAAiB;IACF;QAAzB,QAAQ,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;kCAAY,IAAI;iDAAC;IAChB;QAAzB,QAAQ,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;kCAAY,IAAI;iDAAC;IAHxB,UAAU;QAD/B,QAAQ,EAAE;OACW,UAAU,CAmD/B;IAAD,iBAAC;CAAA,IAAA;SAnDqB,UAAU","sourcesContent":["import { Property, unserialize } from \"./sails.serialize\";\r\nimport { SailsModelInterface } from \"./sails.model.interface\";\r\nimport { Endpoint } from \"./sails.decorator.endpoint\";\r\nimport { isObject } from \"./utils\";\r\n\r\n@Endpoint()\r\nexport abstract class SailsModel implements SailsModelInterface {\r\n    @Property() id: string = \"\";\r\n    @Property({ type: Date }) createdAt: Date;\r\n    @Property({ type: Date }) updatedAt: Date;\r\n\r\n    getEndPoint(): string {\r\n        return this.getEndPoint();\r\n    }\r\n\r\n    static serialize<U extends SailsModelInterface>(model: U): U {\r\n        const recr = (obj) => {\r\n            for (const key in obj) {\r\n                const prop: U = obj[key];\r\n                // Ignore NULL values\r\n                if (prop === null || typeof prop === \"function\") {\r\n                    delete obj[key];\r\n                }\r\n\r\n                // Convert Property Models to their ID representations\r\n                if (prop && prop instanceof SailsModel && prop.id !== null) {\r\n                    obj[key] = prop.id;\r\n                }\r\n\r\n                if (prop && prop instanceof SailsModel) {\r\n                    obj[key] = SailsModel.serialize(prop);\r\n                }\r\n\r\n                if (prop && prop instanceof Array) {\r\n                    obj[key] = prop.map(ob => {\r\n                        if (ob instanceof SailsModel) {\r\n                            return SailsModel.serialize(ob);\r\n                        }\r\n\r\n                        return ob;\r\n                    });\r\n                }\r\n            }\r\n            return obj;\r\n        };\r\n        return recr(Object.assign({}, model));\r\n    }\r\n\r\n    static unserialize<U extends SailsModelInterface>(modelClazz, data: U | U[]): U | U[] {\r\n        const callFn = (model) => unserialize<U>(modelClazz, model) as U;\r\n        if (Array.isArray(data)) {\r\n            return data.map(callFn);\r\n        } else if (isObject(data)) {\r\n            return callFn(data);\r\n        }\r\n        throw new Error(\"SailsModel.unserialize requires a data parameter of either a Literal Object or an Array of Literal Objects\");\r\n    }\r\n}"]}